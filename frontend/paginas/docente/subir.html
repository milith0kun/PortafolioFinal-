<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Subir Documentos - Sistema de Portafolio Docente</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Subir documentos - Sistema de Portafolio Docente UNSAAC">
  <meta name="keywords" content="subir documentos, upload, archivos, docente, UNSAAC">
  <meta name="author" content="UNSAAC">

  <!-- CSS Principal -->
  <link rel="stylesheet" href="../../assets/css/principal.css">

  <!-- JavaScript -->
  <script src="../../assets/js/nucleo/configuracion.js"></script>
  <script src="../../assets/js/nucleo/autenticacion.js"></script>
  <script src="../../assets/js/paginas/docente/upload-documentos.js" defer></script>

  <!-- Font Awesome para iconos -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body onload="verificarSesion('docente')">

  <!-- Header principal -->
  <header class="main-header">
    <div class="header-top">
      <div class="header-top-container">
        <div class="search-container">
          <input type="text" class="search-input" placeholder="Buscar en portafolios...">
        </div>
        <div class="header-actions">
          <div class="social-icons">
            <a href="https://www.facebook.com/unsaac.oficial" target="_blank" class="social-icon"><i class="fab fa-facebook-f"></i></a>
            <a href="https://twitter.com/unsaac_oficial" target="_blank" class="social-icon"><i class="fab fa-twitter"></i></a>
            <a href="https://www.instagram.com/unsaac_oficial" target="_blank" class="social-icon"><i class="fab fa-instagram"></i></a>
            <a href="https://www.youtube.com/channel/UCunsaac" target="_blank" class="social-icon"><i class="fab fa-youtube"></i></a>
          </div>
          <div class="user-menu">
            <div class="user-icon"><i class="fas fa-graduation-cap"></i></div>
            <span class="user-name">Docente</span>
          </div>
        </div>
      </div>
    </div>

    <div class="header-middle">
      <div class="header-middle-container">
        <div class="logo-container">
          <div class="logo-img">
            <img src="../../assets/imagenes/logos/logo-unsaac.png" alt="Logo UNSAAC">
          </div>
          <div class="logo-text-container">
            <span class="logo-title">Sistema de Portafolio</span>
            <span class="logo-subtitle">Subir Documentos</span>
          </div>
        </div>
      </div>
    </div>

    <div class="header-bottom">
      <div class="header-bottom-container">
        <button class="menu-toggle" aria-label="Abrir menú">
          <i class="fas fa-bars"></i>
        </button>
        <nav class="main-nav">
          <ul class="nav-list">
            <li><a href="tablero.html">Inicio</a></li>
            <li><a href="explorador.html">Mis Portafolios</a></li>
            <li><a href="subir.html" class="active">Subir Documentos</a></li>
            <li><a href="observaciones.html">Observaciones</a></li>
            <li><a href="progreso.html">Mi Progreso</a></li>
            <li><a href="../compartidas/notificaciones.html">Notificaciones</a></li>
            <li><a href="../compartidas/ayuda.html">Ayuda</a></li>
            <li><a href="#" onclick="cerrarSesion()">Cerrar sesión</a></li>
          </ul>
        </nav>
      </div>
    </div>
  </header>

  <!-- Navegación breadcrumb -->
  <nav class="breadcrumb">
    <a href="tablero.html">← Dashboard</a>
    <span class="separator">/</span>
    <span class="current">Subir Documentos</span>
  </nav>

  <main class="main-content">
    <!-- Estado del sistema -->
    <section class="system-status-section">
      <div class="status-banner docente-banner">
        <div class="status-content">
          <div class="status-icon">
            <i class="fas fa-cloud-upload-alt"></i>
          </div>
          <div class="status-text">
            <h3>Estado de Subidas</h3>
            <p id="uploadStatusMessage">El período de subida está activo. Puede cargar documentos a sus portafolios.</p>
          </div>
          <div class="status-indicator">
            <span class="status-badge active" id="uploadStatusBadge">Subidas Activas</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Resumen de subidas -->
    <section class="upload-summary">
      <div class="summary-cards">
        <div class="summary-card uploaded-today">
          <div class="card-icon">
            <i class="fas fa-upload"></i>
          </div>
          <div class="card-info">
            <h3>Subidos Hoy</h3>
            <span class="card-value" id="uploadedToday">3</span>
            <span class="card-label">Archivos</span>
          </div>
        </div>

        <div class="summary-card total-uploaded">
          <div class="card-icon">
            <i class="fas fa-file-check"></i>
          </div>
          <div class="card-info">
            <h3>Total Documentos</h3>
            <span class="card-value" id="totalUploaded">42</span>
            <span class="card-label">En portafolios</span>
          </div>
        </div>

        <div class="summary-card storage-used">
          <div class="card-icon">
            <i class="fas fa-hdd"></i>
          </div>
          <div class="card-info">
            <h3>Almacenamiento</h3>
            <span class="card-value" id="storageUsed">85.2 MB</span>
            <span class="card-label">De 500 MB disponibles</span>
          </div>
        </div>

        <div class="summary-card pending-review">
          <div class="card-icon">
            <i class="fas fa-clock"></i>
          </div>
          <div class="card-info">
            <h3>En Revisión</h3>
            <span class="card-value" id="pendingReview">7</span>
            <span class="card-label">Pendientes verificación</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Información importante -->
    <section class="upload-info">
      <div class="info-cards">
        <div class="info-card requirements-card">
          <div class="card-header">
            <i class="fas fa-info-circle"></i>
            <h3>Requisitos de Archivos</h3>
          </div>
          <div class="card-content">
            <ul class="requirements-list">
              <li><strong>Formatos permitidos:</strong> PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, JPG, PNG</li>
              <li><strong>Tamaño máximo:</strong> 10 MB por archivo</li>
              <li><strong>Nombres:</strong> Sin caracteres especiales (@, #, $, %, etc.)</li>
              <li><strong>Codificación:</strong> Utilizar nombres descriptivos</li>
              <li><strong>Versiones:</strong> El sistema maneja versiones automáticamente</li>
            </ul>
          </div>
        </div>

        <div class="info-card tips-card">
          <div class="card-header">
            <i class="fas fa-lightbulb"></i>
            <h3>Consejos de Organización</h3>
          </div>
          <div class="card-content">
            <ul class="tips-list">
              <li>Use nombres descriptivos para sus archivos</li>
              <li>Organice por tipo de documento y fecha</li>
              <li>Revise la estructura de carpetas antes de subir</li>
              <li>Mantenga versiones actualizadas de documentos importantes</li>
              <li>Utilice las descripciones para facilitar búsquedas futuras</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Selección de destino -->
    <section class="destination-selection">
      <div class="selection-header">
        <h2><i class="fas fa-crosshairs"></i> Seleccionar Destino</h2>
        <p>Seleccione la asignatura y carpeta donde desea subir sus documentos</p>
      </div>

      <div class="selection-form">
        <div class="form-row">
          <div class="form-group">
            <label for="selectAsignatura">Asignatura</label>
            <select id="selectAsignatura" onchange="cargarEstructura()" required>
              <option value="">Seleccionar asignatura...</option>
              <!-- Se cargará dinámicamente -->
            </select>
          </div>

          <div class="form-group">
            <label for="selectSemestre">Semestre</label>
            <select id="selectSemestre" onchange="cargarEstructura()">
              <option value="">Todos los semestres</option>
              <!-- Se cargará dinámicamente -->
            </select>
          </div>
        </div>

        <!-- Estructura de carpetas -->
        <div class="folder-structure" id="folderStructure" style="display: none;">
          <h3>Estructura de Portafolio</h3>
          <div class="structure-tree" id="structureTree">
            <!-- Se cargará dinámicamente -->
          </div>
        </div>

        <!-- Carpeta seleccionada -->
        <div class="selected-destination" id="selectedDestination" style="display: none;">
          <div class="destination-info">
            <h4>Destino seleccionado:</h4>
            <div class="destination-path" id="destinationPath">
              <!-- Se mostrará la ruta seleccionada -->
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Zona de subida -->
    <section class="upload-zone-section">
      <h2><i class="fas fa-cloud-upload-alt"></i> Subir Documentos</h2>
      
      <!-- Métodos de subida -->
      <div class="upload-methods">
        <div class="method-tabs">
          <button class="tab-btn active" data-method="single" onclick="cambiarMetodo('single')">
            <i class="fas fa-file"></i> Archivo Individual
          </button>
          <button class="tab-btn" data-method="multiple" onclick="cambiarMetodo('multiple')">
            <i class="fas fa-files"></i> Múltiples Archivos
          </button>
          <button class="tab-btn" data-method="zip" onclick="cambiarMetodo('zip')">
            <i class="fas fa-file-archive"></i> Archivo ZIP
          </button>
        </div>

        <!-- Subida individual -->
        <div class="upload-method active" id="singleUpload">
          <form id="singleUploadForm" enctype="multipart/form-data">
            <div class="upload-area">
              <div class="drop-zone" id="dropZoneSingle">
                <div class="drop-content">
                  <i class="fas fa-cloud-upload-alt fa-3x"></i>
                  <h3>Arrastra tu archivo aquí</h3>
                  <p>o haz clic para seleccionar</p>
                  <input type="file" id="fileSingle" name="archivo" accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.png">
                </div>
              </div>
            </div>

            <div class="file-details" id="fileDetailsSingle" style="display: none;">
              <div class="file-info">
                <div class="file-icon" id="fileIconSingle"></div>
                <div class="file-data">
                  <span class="file-name" id="fileNameSingle"></span>
                  <span class="file-size" id="fileSizeSingle"></span>
                </div>
                <button type="button" onclick="removerArchivo('single')" class="remove-file">
                  <i class="fas fa-times"></i>
                </button>
              </div>

              <div class="metadata-form">
                <div class="form-group">
                  <label for="descripcionSingle">Descripción del documento</label>
                  <input type="text" id="descripcionSingle" name="descripcion" placeholder="Descripción breve del contenido" required>
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label for="tipoDocumentoSingle">Tipo de documento</label>
                    <select id="tipoDocumentoSingle" name="tipo_documento">
                      <option value="">Seleccionar tipo...</option>
                      <option value="syllabus">Syllabus</option>
                      <option value="examen">Examen</option>
                      <option value="practica">Práctica</option>
                      <option value="laboratorio">Laboratorio</option>
                      <option value="proyecto">Proyecto</option>
                      <option value="tarea">Tarea</option>
                      <option value="evaluacion">Evaluación</option>
                      <option value="presentacion">Presentación</option>
                      <option value="material_clase">Material de Clase</option>
                      <option value="rubro">Rubro</option>
                      <option value="otro">Otro</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="versionSingle">Versión</label>
                    <select id="versionSingle" name="version">
                      <option value="nueva">Nueva versión</option>
                      <option value="reemplazar">Reemplazar existente</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label for="tagsSingle">Etiquetas (opcional)</label>
                  <input type="text" id="tagsSingle" name="tags" placeholder="Separar etiquetas con comas">
                </div>
              </div>
            </div>

            <!-- Campos ocultos -->
            <input type="hidden" name="portafolio_id" id="portafolioIdSingle">
            <input type="hidden" name="carpeta_id" id="carpetaIdSingle">

            <div class="upload-actions">
              <button type="submit" class="btn btn-primary" id="uploadBtnSingle" disabled>
                <i class="fas fa-upload"></i>
                <span class="btn-text">Subir Documento</span>
                <div class="loading-spinner" style="display: none;">
                  <i class="fas fa-spinner fa-spin"></i>
                </div>
              </button>
              <button type="reset" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancelar
              </button>
            </div>
          </form>
        </div>

        <!-- Subida múltiple -->
        <div class="upload-method" id="multipleUpload" style="display: none;">
          <form id="multipleUploadForm" enctype="multipart/form-data">
            <div class="upload-area">
              <div class="drop-zone" id="dropZoneMultiple">
                <div class="drop-content">
                  <i class="fas fa-files fa-3x"></i>
                  <h3>Arrastra múltiples archivos aquí</h3>
                  <p>o haz clic para seleccionar varios archivos</p>
                  <input type="file" id="filesMultiple" name="archivos[]" multiple accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.png">
                </div>
              </div>
            </div>

            <div class="files-list" id="filesListMultiple" style="display: none;">
              <h3>Archivos seleccionados</h3>
              <div class="files-container" id="filesContainerMultiple">
                <!-- Se llenarán dinámicamente -->
              </div>

              <div class="batch-metadata">
                <h4>Configuración para todos los archivos</h4>
                <div class="form-row">
                  <div class="form-group">
                    <label for="tipoDocumentoMultiple">Tipo de documento</label>
                    <select id="tipoDocumentoMultiple" name="tipo_documento_batch">
                      <option value="">Aplicar a todos...</option>
                      <option value="syllabus">Syllabus</option>
                      <option value="examen">Examen</option>
                      <option value="practica">Práctica</option>
                      <option value="laboratorio">Laboratorio</option>
                      <option value="proyecto">Proyecto</option>
                      <option value="otro">Otro</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="tagsMultiple">Etiquetas comunes</label>
                    <input type="text" id="tagsMultiple" name="tags_batch" placeholder="Etiquetas para todos los archivos">
                  </div>
                </div>
              </div>
            </div>

            <div class="upload-actions">
              <button type="submit" class="btn btn-primary" id="uploadBtnMultiple" disabled>
                <i class="fas fa-upload"></i>
                <span class="btn-text">Subir Archivos</span>
                <div class="loading-spinner" style="display: none;">
                  <i class="fas fa-spinner fa-spin"></i>
                </div>
              </button>
              <button type="reset" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancelar
              </button>
            </div>
          </form>
        </div>

        <!-- Subida ZIP -->
        <div class="upload-method" id="zipUpload" style="display: none;">
          <form id="zipUploadForm" enctype="multipart/form-data">
            <div class="upload-area">
              <div class="drop-zone" id="dropZoneZip">
                <div class="drop-content">
                  <i class="fas fa-file-archive fa-3x"></i>
                  <h3>Arrastra un archivo ZIP aquí</h3>
                  <p>Se extraerá automáticamente manteniendo la estructura de carpetas</p>
                  <input type="file" id="fileZip" name="archivo_zip" accept=".zip">
                </div>
              </div>
            </div>

            <div class="zip-options" id="zipOptions" style="display: none;">
              <h3>Opciones de extracción</h3>
              
              <div class="option-group">
                <label class="checkbox-container">
                  <input type="checkbox" id="maintainStructure" name="mantener_estructura" checked>
                  <span class="checkmark"></span>
                  Mantener estructura de carpetas del ZIP
                </label>
              </div>

              <div class="option-group">
                <label class="checkbox-container">
                  <input type="checkbox" id="overwriteFiles" name="sobrescribir_archivos">
                  <span class="checkmark"></span>
                  Sobrescribir archivos existentes
                </label>
              </div>

              <div class="form-group">
                <label for="zipDescription">Descripción del lote</label>
                <input type="text" id="zipDescription" name="descripcion_lote" placeholder="Descripción para todos los archivos del ZIP">
              </div>
            </div>

            <div class="upload-actions">
              <button type="submit" class="btn btn-primary" id="uploadBtnZip" disabled>
                <i class="fas fa-upload"></i>
                <span class="btn-text">Subir y Extraer ZIP</span>
                <div class="loading-spinner" style="display: none;">
                  <i class="fas fa-spinner fa-spin"></i>
                </div>
              </button>
              <button type="reset" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Progreso de subida -->
    <section class="upload-progress-section" id="uploadProgressSection" style="display: none;">
      <h2><i class="fas fa-tasks"></i> Progreso de Subida</h2>
      
      <div class="progress-container">
        <div class="overall-progress">
          <div class="progress-header">
            <span class="progress-label">Progreso general</span>
            <span class="progress-percentage" id="overallPercentage">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="overallProgress"></div>
          </div>
        </div>

        <div class="files-progress" id="filesProgress">
          <!-- Se llenarán dinámicamente con el progreso de cada archivo -->
        </div>

        <div class="upload-summary-results" id="uploadSummaryResults" style="display: none;">
          <div class="summary-header">
            <h3>Resumen de Subida</h3>
          </div>
          <div class="summary-stats">
            <div class="stat-item success">
              <span class="stat-value" id="successCount">0</span>
              <span class="stat-label">Exitosos</span>
            </div>
            <div class="stat-item error">
              <span class="stat-value" id="errorCount">0</span>
              <span class="stat-label">Errores</span>
            </div>
            <div class="stat-item total">
              <span class="stat-value" id="totalCount">0</span>
              <span class="stat-label">Total</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Archivos recientes -->
    <section class="recent-uploads">
      <h2><i class="fas fa-history"></i> Subidas Recientes</h2>
      
      <div class="recent-files-container">
        <div class="table-container">
          <table class="recent-files-table">
            <thead>
              <tr>
                <th>Archivo</th>
                <th>Asignatura</th>
                <th>Ubicación</th>
                <th>Fecha</th>
                <th>Estado</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody id="recentFilesList">
              <tr>
                <td colspan="6" class="loading">Cargando archivos recientes...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal de confirmación -->
  <div id="confirmModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Confirmar Acción</h3>
        <span class="close" onclick="cerrarModal('confirmModal')">&times;</span>
      </div>
      <div class="modal-body">
        <p id="confirmMessage">¿Está seguro de realizar esta acción?</p>
      </div>
      <div class="modal-footer">
        <button onclick="confirmarAccion()" class="btn btn-primary" id="confirmBtn">Confirmar</button>
        <button onclick="cerrarModal('confirmModal')" class="btn btn-secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="main-footer">
    <div class="footer-container">
      <div class="footer-info">
        <p>&copy; 2025 Sistema de Portafolio Docente. Todos los derechos reservados.</p>
      </div>
      <div class="footer-links">
        <a href="#">Términos y Condiciones</a>
        <a href="#">Política de Privacidad</a>
        <a href="../compartidas/ayuda.html">Ayuda</a>
      </div>
    </div>
  </footer>
</body>
</html>